// Copyright 2015 by Paulo Augusto Peccin. See license.txt distributed with this file.

wmsx.YM2413MixedAudioChannels = function() {
    var self = this;

    function init() {
        ST = SIN_TABLE;
        ET = EXP_TABLE;
        Y = self;
    }

    this.powerOn = function() {
    };

    this.powerOff = function() {
    };

    this.getSin = function(val) {
        var res = SIN_TABLE[((val & 256) ? val ^ 255 : val) & 255];      // Flip if in mirrored quarters
        if (val & 512) res |= 0x8000;                                    // Set sign bit if in negative quarters
        return res;
    };

    this.getExp = function(val) {
        var exp = EXP_TABLE[(val & 255) ^ 255];
        var res = exp >>> ((val & 0x7F00) >> 8);
        if (val & 0x8000) res = ~res;                                    // Negate if sign bit was set
        return res >> 4;
    };


    init();


    var SIN_TABLE = [
        2137, 1731, 1543, 1419, 1326, 1252, 1190, 1137, 1091, 1050, 1013, 979, 949, 920, 894, 869,
        846, 825, 804, 785, 767, 749, 732, 717, 701, 687, 672, 659, 646, 633, 621, 609,
        598, 587, 576, 566, 556, 546, 536, 527, 518, 509, 501, 492, 484, 476, 468, 461,
        453, 446, 439, 432, 425, 418, 411, 405, 399, 392, 386, 380, 375, 369, 363, 358,
        352, 347, 341, 336, 331, 326, 321, 316, 311, 307, 302, 297, 293, 289, 284, 280,
        276, 271, 267, 263, 259, 255, 251, 248, 244, 240, 236, 233, 229, 226, 222, 219,
        215, 212, 209, 205, 202, 199, 196, 193, 190, 187, 184, 181, 178, 175, 172, 169,
        167, 164, 161, 159, 156, 153, 151, 148, 146, 143, 141, 138, 136, 134, 131, 129,
        127, 125, 122, 120, 118, 116, 114, 112, 110, 108, 106, 104, 102, 100, 98, 96,
        94, 92, 91, 89, 87, 85, 83, 82, 80, 78, 77, 75, 74, 72, 70, 69,
        67, 66, 64, 63, 62, 60, 59, 57, 56, 55, 53, 52, 51, 49, 48, 47,
        46, 45, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 33, 32, 31, 30,
        29, 28, 27, 26, 25, 24, 23, 23, 22, 21, 20, 20, 19, 18, 17, 17,
        16, 15, 15, 14, 13, 13, 12, 12, 11, 10, 10, 9, 9, 8, 8, 7,
        7, 7, 6, 6, 5, 5, 5, 4, 4, 4, 3, 3, 3, 2, 2, 2,
        2, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0
    ];

    var EXP_TABLE = [
        2048, 2054, 2060, 2064, 2070, 2076, 2082, 2088, 2092, 2098, 2104, 2110, 2116, 2122, 2128, 2132,
        2138, 2144, 2150, 2156, 2162, 2168, 2174, 2180, 2186, 2192, 2198, 2204, 2210, 2216, 2222, 2228,
        2234, 2240, 2246, 2252, 2258, 2264, 2270, 2276, 2282, 2288, 2294, 2300, 2308, 2314, 2320, 2326,
        2332, 2338, 2344, 2352, 2358, 2364, 2370, 2376, 2384, 2390, 2396, 2402, 2410, 2416, 2422, 2428,
        2436, 2442, 2448, 2456, 2462, 2468, 2476, 2482, 2488, 2496, 2502, 2510, 2516, 2522, 2530, 2536,
        2544, 2550, 2558, 2564, 2572, 2578, 2584, 2592, 2600, 2606, 2614, 2620, 2628, 2634, 2642, 2648,
        2656, 2664, 2670, 2678, 2684, 2692, 2700, 2706, 2714, 2722, 2728, 2736, 2744, 2752, 2758, 2766,
        2774, 2782, 2788, 2796, 2804, 2812, 2818, 2826, 2834, 2842, 2850, 2858, 2866, 2872, 2880, 2888,
        2896, 2904, 2912, 2920, 2928, 2936, 2944, 2952, 2960, 2968, 2976, 2984, 2992, 3000, 3008, 3016,
        3024, 3032, 3040, 3050, 3058, 3066, 3074, 3082, 3090, 3100, 3108, 3116, 3124, 3132, 3142, 3150,
        3158, 3168, 3176, 3184, 3192, 3202, 3210, 3218, 3228, 3236, 3246, 3254, 3262, 3272, 3280, 3290,
        3298, 3308, 3316, 3326, 3334, 3344, 3352, 3362, 3370, 3380, 3388, 3398, 3408, 3416, 3426, 3434,
        3444, 3454, 3464, 3472, 3482, 3492, 3500, 3510, 3520, 3530, 3538, 3548, 3558, 3568, 3578, 3588,
        3596, 3606, 3616, 3626, 3636, 3646, 3656, 3666, 3676, 3686, 3696, 3706, 3716, 3726, 3736, 3746,
        3756, 3766, 3776, 3786, 3796, 3808, 3818, 3828, 3838, 3848, 3860, 3870, 3880, 3890, 3902, 3912,
        3922, 3932, 3944, 3954, 3966, 3976, 3986, 3998, 4008, 4020, 4030, 4040, 4052, 4062, 4074, 4084
    ];

};

